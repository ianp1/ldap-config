<div>
  Bitte gib hier deine Fablab-Zugangsdaten ein um eine neue Einweisung einzutragen:

  <br>
  <div class="input-mask">
    <form [formGroup]="loginForm">
      <login
          [usernameControl]="'username'"
          [passwordControl]="'password'"
          [formGroup]="loginForm"
          (validLogin)="valid=$event"
          >
      </login>
      <!--
      <mat-form-field>
        <input matInput
            placeholder="Nutzername"
            value=""
            (input)='checkLogin()'
            formControlName="username"
        >
      </mat-form-field>
      <mat-form-field>
        <input matInput
            placeholder="Passwort"
            type="password"
            value=""
            (input)='checkLogin()'
            formControlName="password"
        >
      </mat-form-field>
      <span [class]="validating ? '' : 'hidden'">
        <mat-spinner [diameter]="25" aria-label="test"></mat-spinner>
      </span>
    -->
    </form>
  </div>
  <div *ngIf="valid">
    <p>
      Einweisungsdaten:
    </p>
    <div class="input-mask">
      <form [formGroup]="einweisungForm">
        <mat-form-field>
          <input
              matInput
              placeholder="Eingewiesener"
              value=""
              [matAutocomplete]="auto"
              (input)='fetchUsers()'
              [(ngModel)]="this.eingewiesener"
              formControlName="eingewiesener"
          >
          <mat-autocomplete #auto="matAutocomplete">
            <mat-option *ngFor="let user of users" [value]="user.dn">{{user.vorname}} {{user.nachname}}</mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <mat-form-field>
          <mat-select
              placeholder="Gerät"
              [(ngModel)]="this.maschine"
              formControlName="maschine"
          >
            <mat-option *ngFor="let maschine of maschinen" [value]="maschine.dn">
              {{maschine.name}}
            </mat-option>
          </mat-select>
        </mat-form-field>
        <span [class]="searching? '' : 'hidden'">
          <mat-spinner [diameter]="25" aria-label="test"></mat-spinner>
        </span>

        <br>
        <br>
        <mat-checkbox
          formControlName="useCurrentDate"
        >
          Für aktuelles Datum eintragen
        </mat-checkbox>
        <div *ngIf="!einweisungControls.useCurrentDate.value" class="einweisungsdatumPicker">
          <mat-form-field >
            <input matInput
                placeholder="Einweisungsdatum"
                value=""
                formControlName="date"
                [matDatepicker]="einweisungsdatumPicker"
            >
            <mat-datepicker #einweisungsdatumPicker>
            </mat-datepicker>

            <mat-datepicker-toggle matSuffix [for]="einweisungsdatumPicker"></mat-datepicker-toggle>
          </mat-form-field>
        </div>
      </form>
    </div>
    <br>
    <br>

    <button mat-raised-button color="primary" (click)="enterEinweisung()">
      Einweisung eintragen
    </button>
  </div>
</div>
